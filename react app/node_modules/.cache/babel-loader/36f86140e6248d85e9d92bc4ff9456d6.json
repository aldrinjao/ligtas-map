{"ast":null,"code":"import _slicedToArray from\"/home/aldrin/Desktop/proj/ligtas-map/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable react-hooks/exhaustive-deps */import\"./App.css\";import{Circle,FeatureGroup,MapContainer,Marker,TileLayer}from\"react-leaflet\";import Box from\"@mui/material/Box\";import CloseIcon from\"@mui/icons-material/Close\";import Fade from\"@mui/material/Fade\";import IconButton from\"@mui/material/IconButton\";import L from\"leaflet\";import Paper from\"@mui/material/Paper\";import React from\"react\";import{useEffect}from\"react\";import{usePapaParse}from\"react-papaparse\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){var containerRef=React.useRef(null);var groupRef=React.useRef(null);var bufferRadius=20000;var fillOpacity=0.5;var strokeOpacity=0;var mapCenter=[14.5,122];var zoom=8;var maxZoom=12;var minZoom=6;var customIcon=new L.Icon({iconUrl:require(\"./marker.png\"),iconSize:new L.Point(18,15)});var _usePapaParse=usePapaParse(),readRemoteFile=_usePapaParse.readRemoteFile;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),stations=_React$useState2[0],setStations=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),checked=_React$useState4[0],setChecked=_React$useState4[1];var _React$useState5=React.useState(null),_React$useState6=_slicedToArray(_React$useState5,2),highlight=_React$useState6[0],setHighlight=_React$useState6[1];var _React$useState7=React.useState(null),_React$useState8=_slicedToArray(_React$useState7,2),values=_React$useState8[0],setValues=_React$useState8[1];var _React$useState9=React.useState(null),_React$useState10=_slicedToArray(_React$useState9,2),map=_React$useState10[0],setMap=_React$useState10[1];var url=\"https://docs.google.com/spreadsheets/d/e/2PACX-1vQcuVE7J9YLh5q8cy0QlFVJCKQ1VTxwywwVmtKA52vWIf-I62jCL0NrFnyEHGdLbPqXrqN7Y8rUtCT-/pub?output=csv\";useEffect(function(){readRemoteFile(url,{complete:function complete(results){results.data.shift();setStations(results.data);},download:true});console.log(groupRef);},[]);useEffect(function(){if(!!highlight){highlight.setStyle({color:\"yellow\",opacity:1});}},[highlight]);var panel=/*#__PURE__*/_jsxs(Paper,{sx:{width:\"50px\",height:\"200px\"},elevation:3,children:[!!values?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Box,{sx:{m:3,mt:8},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:500,fontSize:\"1.2rem\"},children:values[0]}),/*#__PURE__*/_jsx(\"br\",{}),\"Date: \",values[15],/*#__PURE__*/_jsx(\"br\",{}),\"Status: \",values[2],/*#__PURE__*/_jsx(\"br\",{}),\"Elevation: \",values[5],/*#__PURE__*/_jsx(\"br\",{}),\"Current Rainfall: \",values[14],\"mm\",/*#__PURE__*/_jsx(\"br\",{}),\"Total Rainfall: \",values[10],\"mm\",/*#__PURE__*/_jsx(\"br\",{}),\"Location: \",values[6],\", \",values[7],\", \",values[8],\", \",values[9]]})}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"close\",sx:{position:\"absolute\",top:\"10px\",right:\"10px\"},onClick:function onClick(){return setChecked(false);},children:/*#__PURE__*/_jsx(CloseIcon,{})})]});return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(MapContainer,{style:{zIndex:4},center:mapCenter,minZoom:minZoom,zoom:zoom,maxZoom:maxZoom,ref:setMap,children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"}),/*#__PURE__*/_jsx(FeatureGroup,{ref:groupRef,children:stations.map(function(value,index){var center=[parseFloat(value[3]),parseFloat(value[4])];var classif=parseFloat(value[11]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Circle,{center:center,pathOptions:getColor(classif),radius:bufferRadius,opacity:strokeOpacity,fillOpacity:fillOpacity,eventHandlers:{click:function click(e){highlightFeature(e,value);}}}),/*#__PURE__*/_jsx(Marker,{position:center,icon:customIcon})]},index);})})]}),/*#__PURE__*/_jsx(Fade,{in:checked,style:{position:\"absolute\",top:\"20px\",right:\"20px\",width:\"300px\",height:\"500px\",zIndex:4},children:panel})]})});function highlightFeature(event,values){setChecked(true);var layer=event.sourceTarget;setHighlight(layer);setValues(values);// layer.setStyle({\n//   color: \"yellow\",\n//   opacity: 1,\n// });\n// let temp = counter;\n// temp++;\n// setCounter(temp);\n}function removehighlightFeature(event,rain){setChecked(function(prev){return!prev;});console.log(event);var layer=event.sourceTarget;layer.setStyle(getColor(rain));}function getColor(classif){var colors=[\"#38B75F\",\"#FCFD31\",\"#FFBD59\",\"#FE0100\",\"#313D39\"];return{fillColor:colors[classif],color:colors[classif],opacity:0};}}export default App;","map":{"version":3,"names":["Circle","FeatureGroup","MapContainer","Marker","TileLayer","Box","CloseIcon","Fade","IconButton","L","Paper","React","useEffect","usePapaParse","App","containerRef","useRef","groupRef","bufferRadius","fillOpacity","strokeOpacity","mapCenter","zoom","maxZoom","minZoom","customIcon","Icon","iconUrl","require","iconSize","Point","readRemoteFile","useState","stations","setStations","checked","setChecked","highlight","setHighlight","values","setValues","map","setMap","url","complete","results","data","shift","download","console","log","setStyle","color","opacity","panel","width","height","m","mt","fontWeight","fontSize","position","top","right","zIndex","value","index","center","parseFloat","classif","getColor","click","e","highlightFeature","event","layer","sourceTarget","removehighlightFeature","rain","prev","colors","fillColor"],"sources":["/home/aldrin/Desktop/proj/ligtas-map/src/App.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport \"./App.css\";\n\nimport {\n  Circle,\n  FeatureGroup,\n  MapContainer,\n  Marker,\n  TileLayer,\n} from \"react-leaflet\";\n\nimport Box from \"@mui/material/Box\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport Fade from \"@mui/material/Fade\";\nimport IconButton from \"@mui/material/IconButton\";\nimport L from \"leaflet\";\nimport { LatLngExpression } from \"leaflet\";\nimport Paper from \"@mui/material/Paper\";\nimport React from \"react\";\nimport { useEffect } from \"react\";\nimport { usePapaParse } from \"react-papaparse\";\n\nfunction App() {\n  const containerRef = React.useRef(null);\n  const groupRef = React.useRef(null);\n\n  const bufferRadius = 20000;\n  const fillOpacity = 0.5;\n  const strokeOpacity = 0;\n  const mapCenter: LatLngExpression = [14.5, 122];\n  const zoom = 8;\n  const maxZoom = 12;\n  const minZoom = 6;\n  const customIcon = new L.Icon({\n    iconUrl: require(\"./marker.png\"),\n    iconSize: new L.Point(18, 15),\n  });\n\n  const { readRemoteFile } = usePapaParse();\n  const [stations, setStations] = React.useState<any>([]);\n  const [checked, setChecked] = React.useState(false);\n  const [highlight, setHighlight] = React.useState<any>(null);\n  const [values, setValues] = React.useState<any>(null);\n  const [map, setMap] = React.useState<any>(null);\n\n  const url =\n    \"https://docs.google.com/spreadsheets/d/e/2PACX-1vQcuVE7J9YLh5q8cy0QlFVJCKQ1VTxwywwVmtKA52vWIf-I62jCL0NrFnyEHGdLbPqXrqN7Y8rUtCT-/pub?output=csv\";\n\n  useEffect(() => {\n    readRemoteFile(url, {\n      complete: (results) => {\n        results.data.shift();\n        setStations(results.data);\n      },\n      download: true,\n    });\n    console.log(groupRef);\n  }, []);\n\n  useEffect(() => {\n    if (!!highlight) {\n      highlight.setStyle({\n        color: \"yellow\",\n        opacity: 1,\n      });\n    }\n  }, [highlight]);\n\n  const panel = (\n    <Paper sx={{ width: \"50px\", height: \"200px\" }} elevation={3}>\n      {!!values ? (\n        <>\n          <Box sx={{ m: 3, mt: 8 }}>\n            <span style={{ fontWeight: 500, fontSize: \"1.2rem\" }}>\n              {values[0]}\n            </span>\n            <br></br>\n            Date: {values[15]}\n            <br></br>\n            Status: {values[2]}\n            <br></br>\n            Elevation: {values[5]}\n            <br></br>\n            Current Rainfall: {values[14]}mm\n            <br></br>\n            Total Rainfall: {values[10]}mm\n            <br></br>\n            Location: {values[6]}, {values[7]}, {values[8]}, {values[9]}\n          </Box>\n        </>\n      ) : (\n        <></>\n      )}\n      <IconButton\n        aria-label=\"close\"\n        sx={{ position: \"absolute\", top: \"10px\", right: \"10px\" }}\n        onClick={() => setChecked(false)}\n      >\n        <CloseIcon></CloseIcon>\n      </IconButton>\n    </Paper>\n  );\n\n  return (\n    <div className=\"App\">\n      <Box>\n        <MapContainer\n          style={{ zIndex: 4 }}\n          center={mapCenter}\n          minZoom={minZoom}\n          zoom={zoom}\n          maxZoom={maxZoom}\n          ref={setMap}\n        >\n          <TileLayer\n            attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n            url=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\n          />\n          <FeatureGroup ref={groupRef}>\n            {stations.map((value: any, index: any) => {\n              let center: LatLngExpression = [\n                parseFloat(value[3]),\n                parseFloat(value[4]),\n              ];\n\n              let classif = parseFloat(value[11]);\n              return(\n                <div key={index}>\n                  <Circle\n                    center={center}\n                    pathOptions={getColor(classif)}\n                    radius={bufferRadius}\n                    opacity={strokeOpacity}\n                    fillOpacity={fillOpacity}\n                    eventHandlers={{\n                      click: (e) => {\n                        highlightFeature(e, value);\n                      },\n                    }}\n                  ></Circle>\n                  <Marker position={center} icon={customIcon}></Marker>\n                </div>\n              );\n            })}\n          </FeatureGroup>\n        </MapContainer>\n        <Fade\n          in={checked}\n          style={{\n            position: \"absolute\",\n            top: \"20px\",\n            right: \"20px\",\n            width: \"300px\",\n            height: \"500px\",\n            zIndex: 4,\n          }}\n        >\n          {panel}\n        </Fade>\n      </Box>\n    </div>\n  );\n\n  function highlightFeature(event: any, values: any) {\n    setChecked(true);\n    let layer = event.sourceTarget;\n    setHighlight(layer);\n    setValues(values);\n\n    // layer.setStyle({\n    //   color: \"yellow\",\n    //   opacity: 1,\n    // });\n    // let temp = counter;\n    // temp++;\n    // setCounter(temp);\n  }\n\n  function removehighlightFeature(event: any, rain: any) {\n    setChecked((prev) => !prev);\n    console.log(event);\n    let layer = event.sourceTarget;\n    layer.setStyle(getColor(rain));\n  }\n\n  function getColor(classif: number) {\n    var colors = [\"#38B75F\", \"#FCFD31\", \"#FFBD59\", \"#FE0100\", \"#313D39\"];\n\n    return { fillColor: colors[classif], color: colors[classif], opacity: 0 };\n  }\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}